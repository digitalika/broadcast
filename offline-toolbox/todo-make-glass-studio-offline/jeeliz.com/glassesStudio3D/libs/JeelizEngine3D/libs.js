"use strict";var JETHREE=JETHREE||{};JETHREE.Color=function(a){if(arguments.length===3){return this.fromArray(arguments)}return this.set(a)};JETHREE.Color.prototype={constructor:JETHREE.Color,r:1,g:1,b:1,set:function(a){if(a instanceof JETHREE.Color){this.copy(a)}else{if(typeof a==="number"){this.setHex(a)}else{if(typeof a==="string"){this.setStyle(a)}}}return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(d,c,a){this.r=d;this.g=c;this.b=a;return this},setHSL:function(){function a(d,c,b){if(b<0){b+=1}if(b>1){b-=1}if(b<1/6){return d+(c-d)*6*b}if(b<1/2){return c}if(b<2/3){return d+(c-d)*6*(2/3-b)}return d}return function(d,c,b){d=JETHREE.Math.euclideanModulo(d,1);c=JETHREE.Math.clamp(c,0,1);b=JETHREE.Math.clamp(b,0,1);if(c===0){this.r=this.g=this.b=b}else{var g=b<=0.5?b*(1+c):b+c-(b*c);var e=(2*b)-g;this.r=a(e,g,d+1/3);this.g=a(e,g,d);this.b=a(e,g,d-1/3)}return this}}(),setStyle:function(a){function o(h){if(h===undefined){return}if(parseFloat(h)<1){console.warn("JETHREE.Color: Alpha component of "+a+" will be ignored.")}}var d;if(d=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var g;var b=d[1];var n=d[2];switch(b){case"rgb":case"rgba":if(g=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){this.r=Math.min(255,parseInt(g[1],10))/255;this.g=Math.min(255,parseInt(g[2],10))/255;this.b=Math.min(255,parseInt(g[3],10))/255;o(g[5]);return this}if(g=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){this.r=Math.min(100,parseInt(g[1],10))/100;this.g=Math.min(100,parseInt(g[2],10))/100;this.b=Math.min(100,parseInt(g[3],10))/100;o(g[5]);return this}break;case"hsl":case"hsla":if(g=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){var j=parseFloat(g[1])/360;var q=parseInt(g[2],10)/100;var e=parseInt(g[3],10)/100;o(g[5]);return this.setHSL(j,q,e)}break}}else{if(d=/^\#([A-Fa-f0-9]+)$/.exec(a)){var c=d[1];var p=c.length;if(p===3){this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255;this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255;this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255;return this}else{if(p===6){this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255;this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255;this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255;return this}}}}if(a&&a.length>0){var c=JETHREE.ColorKeywords[a];if(c!==undefined){this.setHex(c)}else{console.warn("JETHREE.Color: Unknown color "+a)}}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){if(b===undefined){b=2}this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(b,c){if(c===undefined){c=2}var a=(c>0)?(1/c):1;this.r=Math.pow(b.r,a);this.g=Math.pow(b.g,a);this.b=Math.pow(b.b,a);return this},convertGammaToLinear:function(){var d=this.r,c=this.g,a=this.b;this.r=d*d;this.g=c*c;this.b=a*a;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return(this.r*255)<<16^(this.g*255)<<8^(this.b*255)<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(p){var o=p||{h:0,s:0,l:0};var a=this.r,e=this.g,j=this.b;var l=Math.max(a,e,j);var c=Math.min(a,e,j);var h,d;var n=(c+l)/2;if(c===l){h=0;d=0}else{var m=l-c;d=n<=0.5?m/(l+c):m/(2-l-c);switch(l){case a:h=(e-j)/m+(e<j?6:0);break;case e:h=(j-a)/m+2;break;case j:h=(a-e)/m+4;break}h/=6}o.h=h;o.s=d;o.l=n;return o},getStyle:function(){return"rgb("+((this.r*255)|0)+","+((this.g*255)|0)+","+((this.b*255)|0)+")"},offsetHSL:function(d,c,a){var b=this.getHSL();b.h+=d;b.s+=c;b.l+=a;this.setHSL(b.h,b.s,b.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(b,a){this.r=b.r+a.r;this.g=b.g+a.g;this.b=b.b+a.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return(a.r===this.r)&&(a.g===this.g)&&(a.b===this.b)},fromArray:function(b,a){if(a===undefined){a=0}this.r=b[a];this.g=b[a+1];this.b=b[a+2];return this},toArray:function(b,a){if(b===undefined){b=[]}if(a===undefined){a=0}b[a]=this.r;b[a+1]=this.g;b[a+2]=this.b;return b}};JETHREE.ColorKeywords={};JETHREE.Quaternion=function(a,d,c,b){this._x=a||0;this._y=d||0;this._z=c||0;this._w=(b!==undefined)?b:1};JETHREE.Quaternion.prototype={constructor:JETHREE.Quaternion,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,d,c,b){this._x=a;this._y=d;this._z=c;this._w=b;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,d){if(a instanceof JETHREE.Euler===false){throw new Error("JETHREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.")}var g=Math.cos(a._x/2);var e=Math.cos(a._y/2);var c=Math.cos(a._z/2);var l=Math.sin(a._x/2);var j=Math.sin(a._y/2);var h=Math.sin(a._z/2);var b=a.order;if(b==="XYZ"){this._x=l*e*c+g*j*h;this._y=g*j*c-l*e*h;this._z=g*e*h+l*j*c;this._w=g*e*c-l*j*h}else{if(b==="YXZ"){this._x=l*e*c+g*j*h;this._y=g*j*c-l*e*h;this._z=g*e*h-l*j*c;this._w=g*e*c+l*j*h}else{if(b==="ZXY"){this._x=l*e*c-g*j*h;this._y=g*j*c+l*e*h;this._z=g*e*h+l*j*c;this._w=g*e*c-l*j*h}else{if(b==="ZYX"){this._x=l*e*c-g*j*h;this._y=g*j*c+l*e*h;this._z=g*e*h-l*j*c;this._w=g*e*c+l*j*h}else{if(b==="YZX"){this._x=l*e*c+g*j*h;this._y=g*j*c+l*e*h;this._z=g*e*h-l*j*c;this._w=g*e*c-l*j*h}else{if(b==="XZY"){this._x=l*e*c-g*j*h;this._y=g*j*c-l*e*h;this._z=g*e*h+l*j*c;this._w=g*e*c+l*j*h}}}}}}if(d!==false){this.onChangeCallback()}return this},setFromAxisAngle:function(c,d){var a=d/2,b=Math.sin(a);this._x=c.x*b;this._y=c.y*b;this._z=c.z*b;this._w=Math.cos(a);this.onChangeCallback();return this},setFromRotationMatrix:function(e){var d=e.elements,l=d[0],j=d[4],h=d[8],c=d[1],b=d[5],a=d[9],p=d[2],o=d[6],n=d[10],g=l+b+n,q;if(g>0){q=0.5/Math.sqrt(g+1);this._w=0.25/q;this._x=(o-a)*q;this._y=(h-p)*q;this._z=(c-j)*q}else{if(l>b&&l>n){q=2*Math.sqrt(1+l-b-n);this._w=(o-a)/q;this._x=0.25*q;this._y=(j+c)/q;this._z=(h+p)/q}else{if(b>n){q=2*Math.sqrt(1+b-l-n);this._w=(h-p)/q;this._x=(j+c)/q;this._y=0.25*q;this._z=(a+o)/q}else{q=2*Math.sqrt(1+n-l-b);this._w=(c-j)/q;this._x=(h+p)/q;this._y=(a+o)/q;this._z=0.25*q}}}this.onChangeCallback();return this},setFromUnitVectors:function(){var c,a;var b=0.000001;return function(d,e){if(c===undefined){c=new JETHREE.Vector3()}a=d.dot(e)+1;if(a<b){a=0;if(Math.abs(d.x)>Math.abs(d.z)){c.set(-d.y,d.x,0)}else{c.set(0,-d.z,d.y)}}else{c.crossVectors(d,e)}this._x=c.x;this._y=c.y;this._z=c.z;this._w=a;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();if(a===0){this._x=0;this._y=0;this._z=0;this._w=1}else{a=1/a;this._x=this._x*a;this._y=this._y*a;this._z=this._z*a;this._w=this._w*a}this.onChangeCallback();return this},multiply:function(a,b){if(b!==undefined){console.warn("JETHREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(a,b)}return this.multiplyQuaternions(this,a)},multiplyQuaternions:function(o,n){var l=o._x,j=o._y,h=o._z,m=o._w;var e=n._x,d=n._y,c=n._z,g=n._w;this._x=l*g+m*e+j*c-h*d;this._y=j*g+m*d+h*e-l*c;this._z=h*g+m*c+l*d-j*e;this._w=m*g-l*e-j*d-h*c;this.onChangeCallback();return this},multiplyVector3:function(a){console.warn("JETHREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(c,n){if(n===0){return this}if(n===1){return this.copy(c)}var l=this._x,j=this._y,h=this._z,m=this._w;var b=m*c._w+l*c._x+j*c._y+h*c._z;if(b<0){this._w=-c._w;this._x=-c._x;this._y=-c._y;this._z=-c._z;b=-b}else{this.copy(c)}if(b>=1){this._w=m;this._x=l;this._y=j;this._z=h;return this}var d=Math.acos(b);var a=Math.sqrt(1-b*b);if(Math.abs(a)<0.001){this._w=0.5*(m+this._w);this._x=0.5*(l+this._x);this._y=0.5*(j+this._y);this._z=0.5*(h+this._z);return this}var g=Math.sin((1-n)*d)/a,e=Math.sin(n*d)/a;this._w=(m*g+this._w*e);this._x=(l*g+this._x*e);this._y=(j*g+this._y*e);this._z=(h*g+this._z*e);this.onChangeCallback();return this},equals:function(a){return(a._x===this._x)&&(a._y===this._y)&&(a._z===this._z)&&(a._w===this._w)},fromArray:function(b,a){if(a===undefined){a=0}this._x=b[a];this._y=b[a+1];this._z=b[a+2];this._w=b[a+3];this.onChangeCallback();return this},toArray:function(b,a){if(b===undefined){b=[]}if(a===undefined){a=0}b[a]=this._x;b[a+1]=this._y;b[a+2]=this._z;b[a+3]=this._w;return b},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};JETHREE.Quaternion.slerp=function(d,c,b,a){return b.copy(d).slerp(c,a)};JETHREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};JETHREE.Vector2.prototype={constructor:JETHREE.Vector2,get width(){return this.x},set width(a){this.x=a},get height(){return this.y},set height(a){this.y=a},set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(b,a){if(a!==undefined){console.warn("JETHREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(b,a)}this.x+=b.x;this.y+=b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(b,a){if(a!==undefined){console.warn("JETHREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(b,a)}this.x-=b.x;this.y-=b.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){if(isFinite(a)){this.x*=a;this.y*=a}else{this.x=0;this.y=0}return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(b,a){this.x=Math.max(b.x,Math.min(a.x,this.x));this.y=Math.max(b.y,Math.min(a.y,this.y));return this},clampScalar:function(){var c,b;return function a(d,e){if(c===undefined){c=new JETHREE.Vector2();b=new JETHREE.Vector2()}c.set(d,d);b.set(e,e);return this.clamp(c,b)}}(),clampLength:function(b,a){var c=this.length();this.multiplyScalar(Math.max(b,Math.min(a,c))/c);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=(this.x<0)?Math.ceil(this.x):Math.floor(this.x);this.y=(this.y<0)?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(c){var b=this.x-c.x,a=this.y-c.y;return b*b+a*a},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(c,b,a){this.subVectors(b,c).multiplyScalar(a).add(c);return this},equals:function(a){return((a.x===this.x)&&(a.y===this.y))},fromArray:function(b,a){if(a===undefined){a=0}this.x=b[a];this.y=b[a+1];return this},toArray:function(b,a){if(b===undefined){b=[]}if(a===undefined){a=0}b[a]=this.x;b[a+1]=this.y;return b},fromAttribute:function(b,a,c){if(c===undefined){c=0}a=a*b.itemSize+c;this.x=b.array[a];this.y=b.array[a+1];return this},rotateAround:function(b,e){var h=Math.cos(e),d=Math.sin(e);var a=this.x-b.x;var g=this.y-b.y;this.x=a*h-g*d+b.x;this.y=a*d+g*h+b.y;return this}};JETHREE.Vector3=function(a,c,b){this.x=a||0;this.y=c||0;this.z=b||0};JETHREE.Vector3.prototype={constructor:JETHREE.Vector3,set:function(a,c,b){this.x=a;this.y=c;this.z=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(b,a){if(a!==undefined){console.warn("JETHREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(b,a)}this.x+=b.x;this.y+=b.y;this.z+=b.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this},sub:function(b,a){if(a!==undefined){console.warn("JETHREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(b,a)}this.x-=b.x;this.y-=b.y;this.z-=b.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;return this},multiply:function(b,a){if(a!==undefined){console.warn("JETHREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(b,a)}this.x*=b.x;this.y*=b.y;this.z*=b.z;return this},multiplyScalar:function(a){if(isFinite(a)){this.x*=a;this.y*=a;this.z*=a}else{this.x=0;this.y=0;this.z=0}return this},multiplyVectors:function(d,c){this.x=d.x*c.x;this.y=d.y*c.y;this.z=d.z*c.z;return this},applyEuler:function(){var a;return function b(c){if(c instanceof JETHREE.Euler===false){console.error("JETHREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.")}if(a===undefined){a=new JETHREE.Quaternion()}this.applyQuaternion(a.setFromEuler(c));return this}}(),applyAxisAngle:function(){var a;return function b(c,d){if(a===undefined){a=new JETHREE.Quaternion()}this.applyQuaternion(a.setFromAxisAngle(c,d));return this}}(),applyMatrix3:function(b){var a=this.x;var g=this.y;var d=this.z;var c=b.elements;this.x=c[0]*a+c[3]*g+c[6]*d;this.y=c[1]*a+c[4]*g+c[7]*d;this.z=c[2]*a+c[5]*g+c[8]*d;return this},applyMatrix4:function(b){var a=this.x,g=this.y,d=this.z;var c=b.elements;this.x=c[0]*a+c[4]*g+c[8]*d+c[12];this.y=c[1]*a+c[5]*g+c[9]*d+c[13];this.z=c[2]*a+c[6]*g+c[10]*d+c[14];return this},applyProjection:function(b){var a=this.x,j=this.y,h=this.z;var c=b.elements;var g=1/(c[3]*a+c[7]*j+c[11]*h+c[15]);this.x=(c[0]*a+c[4]*j+c[8]*h+c[12])*g;this.y=(c[1]*a+c[5]*j+c[9]*h+c[13])*g;this.z=(c[2]*a+c[6]*j+c[10]*h+c[14])*g;return this},applyQuaternion:function(a){var o=this.x;var n=this.y;var m=this.z;var j=a.x;var h=a.y;var g=a.z;var l=a.w;var d=l*o+h*m-g*n;var c=l*n+g*o-j*m;var b=l*m+j*n-h*o;var e=-j*o-h*n-g*m;this.x=d*l+e*-j+c*-g-b*-h;this.y=c*l+e*-h+b*-j-d*-g;this.z=b*l+e*-g+d*-h-c*-j;return this},project:function(){var a;return function b(c){if(a===undefined){a=new JETHREE.Matrix4()}a.multiplyMatrices(c.projectionMatrix,a.getInverse(c.matrixWorld));return this.applyProjection(a)}}(),unproject:function(){var a;return function b(c){if(a===undefined){a=new JETHREE.Matrix4()}a.multiplyMatrices(c.matrixWorld,a.getInverse(c.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(b){var a=this.x,g=this.y,d=this.z;var c=b.elements;this.x=c[0]*a+c[4]*g+c[8]*d;this.y=c[1]*a+c[5]*g+c[9]*d;this.z=c[2]*a+c[6]*g+c[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(b,a){this.x=Math.max(b.x,Math.min(a.x,this.x));this.y=Math.max(b.y,Math.min(a.y,this.y));this.z=Math.max(b.z,Math.min(a.z,this.z));return this},clampScalar:function(){var c,b;return function a(d,e){if(c===undefined){c=new JETHREE.Vector3();b=new JETHREE.Vector3()}c.set(d,d,d);b.set(e,e,e);return this.clamp(c,b)}}(),clampLength:function(b,a){var c=this.length();this.multiplyScalar(Math.max(b,Math.min(a,c))/c);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=(this.x<0)?Math.ceil(this.x):Math.floor(this.x);this.y=(this.y<0)?Math.ceil(this.y):Math.floor(this.y);this.z=(this.z<0)?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(c,b,a){this.subVectors(b,c).multiplyScalar(a).add(c);return this},cross:function(c,b){if(b!==undefined){console.warn("JETHREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(c,b)}var a=this.x,e=this.y,d=this.z;this.x=e*c.z-d*c.y;this.y=d*c.x-a*c.z;this.z=a*c.y-e*c.x;return this},crossVectors:function(d,c){var j=d.x,g=d.y,e=d.z;var m=c.x,l=c.y,h=c.z;this.x=g*h-e*l;this.y=e*m-j*h;this.z=j*l-g*m;return this},projectOnVector:function(){var c,a;return function b(d){if(c===undefined){c=new JETHREE.Vector3()}c.copy(d).normalize();a=this.dot(c);return this.copy(c).multiplyScalar(a)}}(),projectOnPlane:function(){var b;return function a(c){if(b===undefined){b=new JETHREE.Vector3()}b.copy(this).projectOnVector(c);return this.sub(b)}}(),reflect:function(){var b;return function a(c){if(b===undefined){b=new JETHREE.Vector3()}return this.sub(b.copy(c).multiplyScalar(2*this.dot(c)))}}(),angleTo:function(a){var b=this.dot(a)/(this.length()*a.length());return Math.acos(JETHREE.Math.clamp(b,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(d){var c=this.x-d.x;var b=this.y-d.y;var a=this.z-d.z;return c*c+b*b+a*a},setEulerFromRotationMatrix:function(b,a){console.error("JETHREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(b,a){console.error("JETHREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){console.warn("JETHREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("JETHREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(b,a){console.warn("JETHREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(b,a)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var d=this.set(a.elements[0],a.elements[1],a.elements[2]).length();var c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();var b=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=d;this.y=c;this.z=b;return this},setFromMatrixColumn:function(b,a){var d=b*4;var c=a.elements;this.x=c[d];this.y=c[d+1];this.z=c[d+2];return this},equals:function(a){return((a.x===this.x)&&(a.y===this.y)&&(a.z===this.z))},fromArray:function(b,a){if(a===undefined){a=0}this.x=b[a];this.y=b[a+1];this.z=b[a+2];return this},toArray:function(b,a){if(b===undefined){b=[]}if(a===undefined){a=0}b[a]=this.x;b[a+1]=this.y;b[a+2]=this.z;return b},fromAttribute:function(b,a,c){if(c===undefined){c=0}a=a*b.itemSize+c;this.x=b.array[a];this.y=b.array[a+1];this.z=b.array[a+2];return this}};JETHREE.Vector4=function(a,d,c,b){this.x=a||0;this.y=d||0;this.z=c||0;this.w=(b!==undefined)?b:1};JETHREE.Vector4.prototype={constructor:JETHREE.Vector4,set:function(a,d,c,b){this.x=a;this.y=d;this.z=c;this.w=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=(a.w!==undefined)?a.w:1;return this},add:function(b,a){if(a!==undefined){console.warn("JETHREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(b,a)}this.x+=b.x;this.y+=b.y;this.z+=b.z;this.w+=b.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;this.w=d.w+c.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(b,a){if(a!==undefined){console.warn("JETHREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(b,a)}this.x-=b.x;this.y-=b.y;this.z-=b.z;this.w-=b.w;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;this.w=d.w-c.w;return this},multiplyScalar:function(a){if(isFinite(a)){this.x*=a;this.y*=a;this.z*=a;this.w*=a}else{this.x=0;this.y=0;this.z=0;this.w=0}return this},applyMatrix4:function(b){var a=this.x;var h=this.y;var g=this.z;var c=this.w;var d=b.elements;this.x=d[0]*a+d[4]*h+d[8]*g+d[12]*c;this.y=d[1]*a+d[5]*h+d[9]*g+d[13]*c;this.z=d[2]*a+d[6]*h+d[10]*g+d[14]*c;this.w=d[3]*a+d[7]*h+d[11]*g+d[15]*c;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(b){this.w=2*Math.acos(b.w);var a=Math.sqrt(1-b.w*b.w);if(a<0.0001){this.x=1;this.y=0;this.z=0}else{this.x=b.x/a;this.y=b.y/a;this.z=b.z/a}return this},setAxisAngleFromRotationMatrix:function(B){var C,n,l,j,H=0.01,o=0.1,h=B.elements,G=h[0],E=h[4],D=h[8],e=h[1],c=h[5],a=h[9],A=h[2],t=h[6],q=h[10];if((Math.abs(E-e)<H)&&(Math.abs(D-A)<H)&&(Math.abs(a-t)<H)){if((Math.abs(E+e)<o)&&(Math.abs(D+A)<o)&&(Math.abs(a+t)<o)&&(Math.abs(G+c+q-3)<o)){this.set(1,0,0,0);return this}C=Math.PI;var g=(G+1)/2;var u=(c+1)/2;var F=(q+1)/2;var d=(E+e)/4;var b=(D+A)/4;var r=(a+t)/4;if((g>u)&&(g>F)){if(g<H){n=0;l=0.707106781;j=0.707106781}else{n=Math.sqrt(g);l=d/n;j=b/n}}else{if(u>F){if(u<H){n=0.707106781;l=0;j=0.707106781}else{l=Math.sqrt(u);n=d/l;j=r/l}}else{if(F<H){n=0.707106781;l=0.707106781;j=0}else{j=Math.sqrt(F);n=b/j;l=r/j}}}this.set(n,l,j,C);return this}var p=Math.sqrt((t-a)*(t-a)+(D-A)*(D-A)+(e-E)*(e-E));if(Math.abs(p)<0.001){p=1}this.x=(t-a)/p;this.y=(D-A)/p;this.z=(e-E)/p;this.w=Math.acos((G+c+q-1)/2);return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(b,a){this.x=Math.max(b.x,Math.min(a.x,this.x));this.y=Math.max(b.y,Math.min(a.y,this.y));this.z=Math.max(b.z,Math.min(a.z,this.z));this.w=Math.max(b.w,Math.min(a.w,this.w));return this},clampScalar:function(){var c,b;return function a(d,e){if(c===undefined){c=new JETHREE.Vector4();b=new JETHREE.Vector4()}c.set(d,d,d,d);b.set(e,e,e,e);return this.clamp(c,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=(this.x<0)?Math.ceil(this.x):Math.floor(this.x);this.y=(this.y<0)?Math.ceil(this.y):Math.floor(this.y);this.z=(this.z<0)?Math.ceil(this.z):Math.floor(this.z);this.w=(this.w<0)?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(c,b,a){this.subVectors(b,c).multiplyScalar(a).add(c);return this},equals:function(a){return((a.x===this.x)&&(a.y===this.y)&&(a.z===this.z)&&(a.w===this.w))},fromArray:function(b,a){if(a===undefined){a=0}this.x=b[a];this.y=b[a+1];this.z=b[a+2];this.w=b[a+3];return this},toArray:function(b,a){if(b===undefined){b=[]}if(a===undefined){a=0}b[a]=this.x;b[a+1]=this.y;b[a+2]=this.z;b[a+3]=this.w;return b},fromAttribute:function(b,a,c){if(c===undefined){c=0}a=a*b.itemSize+c;this.x=b.array[a];this.y=b.array[a+1];this.z=b.array[a+2];this.w=b.array[a+3];return this}};JETHREE.Euler=function(b,d,c,a){this._x=b||0;this._y=d||0;this._z=c||0;this._order=a||JETHREE.Euler.DefaultOrder};JETHREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];JETHREE.Euler.DefaultOrder="XYZ";JETHREE.Euler.prototype={constructor:JETHREE.Euler,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(b,d,c,a){this._x=b;this._y=d;this._z=c;this._order=a||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(e,g,h){var n=JETHREE.Math.clamp;var d=e.elements;var o=d[0],l=d[4],j=d[8];var c=d[1],b=d[5],a=d[9];var r=d[2],q=d[6],p=d[10];g=g||this._order;if(g==="XYZ"){this._y=Math.asin(n(j,-1,1));if(Math.abs(j)<0.99999){this._x=Math.atan2(-a,p);this._z=Math.atan2(-l,o)}else{this._x=Math.atan2(q,b);this._z=0}}else{if(g==="YXZ"){this._x=Math.asin(-n(a,-1,1));if(Math.abs(a)<0.99999){this._y=Math.atan2(j,p);this._z=Math.atan2(c,b)}else{this._y=Math.atan2(-r,o);this._z=0}}else{if(g==="ZXY"){this._x=Math.asin(n(q,-1,1));if(Math.abs(q)<0.99999){this._y=Math.atan2(-r,p);this._z=Math.atan2(-l,b)}else{this._y=0;this._z=Math.atan2(c,o)}}else{if(g==="ZYX"){this._y=Math.asin(-n(r,-1,1));if(Math.abs(r)<0.99999){this._x=Math.atan2(q,p);this._z=Math.atan2(c,o)}else{this._x=0;this._z=Math.atan2(-l,b)}}else{if(g==="YZX"){this._z=Math.asin(n(c,-1,1));if(Math.abs(c)<0.99999){this._x=Math.atan2(-a,b);this._y=Math.atan2(-r,o)}else{this._x=0;this._y=Math.atan2(j,p)}}else{if(g==="XZY"){this._z=Math.asin(-n(l,-1,1));if(Math.abs(l)<0.99999){this._x=Math.atan2(q,b);this._y=Math.atan2(j,o)}else{this._x=Math.atan2(-a,p);this._y=0}}else{console.warn("JETHREE.Euler: .setFromRotationMatrix() given unsupported order: "+g)}}}}}}this._order=g;if(h!==false){this.onChangeCallback()}return this},setFromQuaternion:function(){var a;return function(c,b,d){if(a===undefined){a=new JETHREE.Matrix4()}a.makeRotationFromQuaternion(c);this.setFromRotationMatrix(a,b,d);return this}}(),setFromVector3:function(b,a){return this.set(b.x,b.y,b.z,a||this._order)},reorder:function(){var a=new JETHREE.Quaternion();return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),equals:function(a){return(a._x===this._x)&&(a._y===this._y)&&(a._z===this._z)&&(a._order===this._order)},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];if(a[3]!==undefined){this._order=a[3]}this.onChangeCallback();return this},toArray:function(b,a){if(b===undefined){b=[]}if(a===undefined){a=0}b[a]=this._x;b[a+1]=this._y;b[a+2]=this._z;b[a+3]=this._order;return b},toVector3:function(a){if(a){return a.set(this._x,this._y,this._z)}else{return new JETHREE.Vector3(this._x,this._y,this._z)}},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};JETHREE.Box3=function(b,a){this.min=(b!==undefined)?b:new JETHREE.Vector3(Infinity,Infinity,Infinity);this.max=(a!==undefined)?a:new JETHREE.Vector3(-Infinity,-Infinity,-Infinity)};JETHREE.Box3.prototype={constructor:JETHREE.Box3,set:function(b,a){this.min.copy(b);this.max.copy(a);return this},setFromPoints:function(c){this.makeEmpty();for(var b=0,a=c.length;b<a;b++){this.expandByPoint(c[b])}return this},setFromCenterAndSize:function(){var a=new JETHREE.Vector3();return function(b,d){var c=a.copy(d).multiplyScalar(0.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),setFromObject:function(){var a=new JETHREE.Vector3();return function(b){var c=this;b.updateMatrixWorld(true);this.makeEmpty();b.traverse(function(j){var l=j.geometry;if(l!==undefined){if(l instanceof JETHREE.Geometry){var g=l.vertices;for(var h=0,e=g.length;h<e;h++){a.copy(g[h]);a.applyMatrix4(j.matrixWorld);c.expandByPoint(a)}}else{if(l instanceof JETHREE.BufferGeometry&&l.attributes.position!==undefined){var d=l.attributes.position.array;for(var h=0,e=d.length;h<e;h+=3){a.set(d[h],d[h+1],d[h+2]);a.applyMatrix4(j.matrixWorld);c.expandByPoint(a)}}}}});return this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return(this.max.x<this.min.x)||(this.max.y<this.min.y)||(this.max.z<this.min.z)},center:function(b){var a=b||new JETHREE.Vector3();return a.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){var a=b||new JETHREE.Vector3();return a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){if(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z){return false}return true},containsBox:function(a){if((this.min.x<=a.min.x)&&(a.max.x<=this.max.x)&&(this.min.y<=a.min.y)&&(a.max.y<=this.max.y)&&(this.min.z<=a.min.z)&&(a.max.z<=this.max.z)){return true}return false},getParameter:function(b,c){var a=c||new JETHREE.Vector3();return a.set((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y),(b.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){if(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z){return false}return true},clampPoint:function(b,c){var a=c||new JETHREE.Vector3();return a.copy(b).clamp(this.min,this.max)},distanceToPoint:function(){var a=new JETHREE.Vector3();return function(b){var c=a.copy(b).clamp(this.min,this.max);return c.sub(b).length()}}(),getBoundingSphere:function(){var a=new JETHREE.Vector3();return function(c){var b=c||new JETHREE.Sphere();b.center=this.center();b.radius=this.size(a).length()*0.5;return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new JETHREE.Vector3(),new JETHREE.Vector3(),new JETHREE.Vector3(),new JETHREE.Vector3(),new JETHREE.Vector3(),new JETHREE.Vector3(),new JETHREE.Vector3(),new JETHREE.Vector3()];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};JETHREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);if(arguments.length>0){console.error("JETHREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}};JETHREE.Matrix3.prototype={constructor:JETHREE.Matrix3,set:function(j,h,g,e,d,c,a,m,l){var b=this.elements;b[0]=j;b[3]=h;b[6]=g;b[1]=e;b[4]=d;b[7]=c;b[2]=a;b[5]=m;b[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(a){var b=a.elements;this.set(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]);return this},multiplyVector3:function(a){console.warn("JETHREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},multiplyVector3Array:function(b){console.warn("JETHREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(b)},applyToVector3Array:function(){var a;return function(g,e,d){if(a===undefined){a=new JETHREE.Vector3()}if(e===undefined){e=0}if(d===undefined){d=g.length}for(var c=0,b=e;c<d;c+=3,b+=3){a.fromArray(g,b);a.applyMatrix3(this);a.toArray(g,b)}return g}}(),applyToBuffer:function(){var b;return function a(c,h,g){if(b===undefined){b=new JETHREE.Vector3()}if(h===undefined){h=0}if(g===undefined){g=c.length/c.itemSize}for(var e=0,d=h;e<g;e++,d++){b.x=c.getX(d);b.y=c.getY(d);b.z=c.getZ(d);b.applyMatrix3(this);c.setXYZ(b.x,b.y,b.z)}return c}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var j=this.elements;var t=j[0],s=j[1],r=j[2],q=j[3],p=j[4],o=j[5],n=j[6],m=j[7],l=j[8];return t*p*l-t*o*m-s*q*l+s*o*n+r*q*m-r*p*n},getInverse:function(b,a){var d=b.elements;var g=this.elements;g[0]=d[10]*d[5]-d[6]*d[9];g[1]=-d[10]*d[1]+d[2]*d[9];g[2]=d[6]*d[1]-d[2]*d[5];g[3]=-d[10]*d[4]+d[6]*d[8];g[4]=d[10]*d[0]-d[2]*d[8];g[5]=-d[6]*d[0]+d[2]*d[4];g[6]=d[9]*d[4]-d[5]*d[8];g[7]=-d[9]*d[0]+d[1]*d[8];g[8]=d[5]*d[0]-d[1]*d[4];var c=d[0]*g[0]+d[1]*g[3]+d[2]*g[6];if(c===0){var e="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(a||false){throw new Error(e)}else{console.warn(e)}this.identity();return this}this.multiplyScalar(1/c);return this},transpose:function(){var b,a=this.elements;b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},flattenToArrayOffset:function(c,b){var a=this.elements;c[b]=a[0];c[b+1]=a[1];c[b+2]=a[2];c[b+3]=a[3];c[b+4]=a[4];c[b+5]=a[5];c[b+6]=a[6];c[b+7]=a[7];c[b+8]=a[8];return c},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(b){var a=this.elements;b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]}};JETHREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);if(arguments.length>0){console.error("JETHREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}};JETHREE.Matrix4.prototype={constructor:JETHREE.Matrix4,set:function(q,p,n,l,g,e,d,c,a,t,s,r,o,m,j,h){var b=this.elements;b[0]=q;b[4]=p;b[8]=n;b[12]=l;b[1]=g;b[5]=e;b[9]=d;b[13]=c;b[2]=a;b[6]=t;b[10]=s;b[14]=r;b[3]=o;b[7]=m;b[11]=j;b[15]=h;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return new JETHREE.Matrix4().fromArray(this.elements)},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){console.warn("JETHREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},copyPosition:function(a){var c=this.elements;var b=a.elements;c[12]=b[12];c[13]=b[13];c[14]=b[14];return this},extractBasis:function(b,a,c){var d=this.elements;b.set(d[0],d[1],d[2]);a.set(d[4],d[5],d[6]);c.set(d[8],d[9],d[10]);return this},makeBasis:function(b,a,c){this.set(b.x,a.x,c.x,0,b.y,a.y,c.y,0,b.z,a.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a;return function(b){if(a===undefined){a=new JETHREE.Vector3()}var h=this.elements;var g=b.elements;var e=1/a.set(g[0],g[1],g[2]).length();var d=1/a.set(g[4],g[5],g[6]).length();var c=1/a.set(g[8],g[9],g[10]).length();h[0]=g[0]*e;h[1]=g[1]*e;h[2]=g[2]*e;h[4]=g[4]*d;h[5]=g[5]*d;h[6]=g[6]*d;h[8]=g[8]*c;h[9]=g[9]*c;h[10]=g[10]*c;return this}}(),makeRotationFromEuler:function(q){if(q instanceof JETHREE.Euler===false){console.error("JETHREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.")}var m=this.elements;var p=q.x,o=q.y,n=q.z;var J=Math.cos(p),I=Math.sin(p);var G=Math.cos(o),D=Math.sin(o);var A=Math.cos(n),t=Math.sin(n);if(q.order==="XYZ"){var C=J*A,u=J*t,h=I*A,g=I*t;m[0]=G*A;m[4]=-G*t;m[8]=D;m[1]=u+h*D;m[5]=C-g*D;m[9]=-I*G;m[2]=g-C*D;m[6]=h+u*D;m[10]=J*G}else{if(q.order==="YXZ"){var s=G*A,r=G*t,F=D*A,B=D*t;m[0]=s+B*I;m[4]=F*I-r;m[8]=J*D;m[1]=J*t;m[5]=J*A;m[9]=-I;m[2]=r*I-F;m[6]=B+s*I;m[10]=J*G}else{if(q.order==="ZXY"){var s=G*A,r=G*t,F=D*A,B=D*t;m[0]=s-B*I;m[4]=-J*t;m[8]=F+r*I;m[1]=r+F*I;m[5]=J*A;m[9]=B-s*I;m[2]=-J*D;m[6]=I;m[10]=J*G}else{if(q.order==="ZYX"){var C=J*A,u=J*t,h=I*A,g=I*t;m[0]=G*A;m[4]=h*D-u;m[8]=C*D+g;m[1]=G*t;m[5]=g*D+C;m[9]=u*D-h;m[2]=-D;m[6]=I*G;m[10]=J*G}else{if(q.order==="YZX"){var H=J*G,E=J*D,l=I*G,j=I*D;m[0]=G*A;m[4]=j-H*t;m[8]=l*t+E;m[1]=t;m[5]=J*A;m[9]=-I*A;m[2]=-D*A;m[6]=E*t+l;m[10]=H-j*t}else{if(q.order==="XZY"){var H=J*G,E=J*D,l=I*G,j=I*D;m[0]=G*A;m[4]=-t;m[8]=D*A;m[1]=H*t+j;m[5]=J*A;m[9]=E*t-l;m[2]=l*t-E;m[6]=I*A;m[10]=j*t+H}}}}}}m[3]=0;m[7]=0;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("JETHREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(o){var e=this.elements;var j=o.x,h=o.y,g=o.z,l=o.w;var r=j+j,a=h+h,m=g+g;var d=j*r,c=j*a,b=j*m;var p=h*a,n=h*m,u=g*m;var A=l*r,t=l*a,s=l*m;e[0]=1-(p+u);e[4]=c-s;e[8]=b+t;e[1]=c+s;e[5]=1-(d+u);e[9]=n-A;e[2]=b-t;e[6]=n+A;e[10]=1-(d+p);e[3]=0;e[7]=0;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return this},lookAt:function(){var a,c,b;return function(e,g,d){if(a===undefined){a=new JETHREE.Vector3()}if(c===undefined){c=new JETHREE.Vector3()}if(b===undefined){b=new JETHREE.Vector3()}var h=this.elements;b.subVectors(e,g).normalize();if(b.lengthSq()===0){b.z=1}a.crossVectors(d,b).normalize();if(a.lengthSq()===0){b.x+=0.0001;a.crossVectors(d,b).normalize()}c.crossVectors(b,a);h[0]=a.x;h[4]=c.x;h[8]=b.x;h[1]=a.y;h[5]=c.y;h[9]=b.y;h[2]=a.z;h[6]=c.z;h[10]=b.z;return this}}(),multiply:function(a,b){if(b!==undefined){console.warn("JETHREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(a,b)}return this.multiplyMatrices(this,a)},multiplyMatrices:function(U,T){var A=U.elements;var S=T.elements;var c=this.elements;var s=A[0],q=A[4],p=A[8],o=A[12];var R=A[1],Q=A[5],P=A[9],O=A[13];var J=A[2],I=A[6],H=A[10],G=A[14];var B=A[3],u=A[7],t=A[11],r=A[15];var l=S[0],h=S[4],e=S[8],d=S[12];var N=S[1],M=S[5],L=S[9],K=S[13];var F=S[2],E=S[6],D=S[10],C=S[14];var n=S[3],m=S[7],j=S[11],g=S[15];c[0]=s*l+q*N+p*F+o*n;c[4]=s*h+q*M+p*E+o*m;c[8]=s*e+q*L+p*D+o*j;c[12]=s*d+q*K+p*C+o*g;c[1]=R*l+Q*N+P*F+O*n;c[5]=R*h+Q*M+P*E+O*m;c[9]=R*e+Q*L+P*D+O*j;c[13]=R*d+Q*K+P*C+O*g;c[2]=J*l+I*N+H*F+G*n;c[6]=J*h+I*M+H*E+G*m;c[10]=J*e+I*L+H*D+G*j;c[14]=J*d+I*K+H*C+G*g;c[3]=B*l+u*N+t*F+r*n;c[7]=B*h+u*M+t*E+r*m;c[11]=B*e+u*L+t*D+r*j;c[15]=B*d+u*K+t*C+r*g;return this},multiplyToArray:function(d,c,e){var g=this.elements;this.multiplyMatrices(d,c);e[0]=g[0];e[1]=g[1];e[2]=g[2];e[3]=g[3];e[4]=g[4];e[5]=g[5];e[6]=g[6];e[7]=g[7];e[8]=g[8];e[9]=g[9];e[10]=g[10];e[11]=g[11];e[12]=g[12];e[13]=g[13];e[14]=g[14];e[15]=g[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("JETHREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return a.applyProjection(this)},multiplyVector4:function(a){console.warn("JETHREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(b){console.warn("JETHREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(b)},applyToVector3Array:function(){var a;return function(g,e,d){if(a===undefined){a=new JETHREE.Vector3()}if(e===undefined){e=0}if(d===undefined){d=g.length}for(var c=0,b=e;c<d;c+=3,b+=3){a.fromArray(g,b);a.applyMatrix4(this);a.toArray(g,b)}return g}}(),applyToBuffer:function(){var b;return function a(c,h,g){if(b===undefined){b=new JETHREE.Vector3()}if(h===undefined){h=0}if(g===undefined){g=c.length/c.itemSize}for(var e=0,d=h;e<g;e++,d++){b.x=c.getX(d);b.y=c.getY(d);b.z=c.getZ(d);b.applyMatrix4(this);c.setXYZ(b.x,b.y,b.z)}return c}}(),rotateAxis:function(a){console.warn("JETHREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("JETHREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var c=this.elements;var q=c[0],p=c[4],n=c[8],l=c[12];var g=c[1],e=c[5],d=c[9],b=c[13];var a=c[2],t=c[6],s=c[10],r=c[14];var o=c[3],m=c[7],j=c[11],h=c[15];return(o*(+l*d*t-n*b*t-l*e*s+p*b*s+n*e*r-p*d*r)+m*(+q*d*r-q*b*s+l*g*s-n*g*r+n*b*a-l*d*a)+j*(+q*b*t-q*e*r-l*g*t+p*g*r+l*e*a-p*b*a)+h*(-n*e*a-q*d*t+q*e*s+n*g*t-p*g*s+p*d*a))},transpose:function(){var b=this.elements;var a;a=b[1];b[1]=b[4];b[4]=a;a=b[2];b[2]=b[8];b[8]=a;a=b[6];b[6]=b[9];b[9]=a;a=b[3];b[3]=b[12];b[12]=a;a=b[7];b[7]=b[13];b[13]=a;a=b[11];b[11]=b[14];b[14]=a;return this},flattenToArrayOffset:function(c,b){var a=this.elements;c[b]=a[0];c[b+1]=a[1];c[b+2]=a[2];c[b+3]=a[3];c[b+4]=a[4];c[b+5]=a[5];c[b+6]=a[6];c[b+7]=a[7];c[b+8]=a[8];c[b+9]=a[9];c[b+10]=a[10];c[b+11]=a[11];c[b+12]=a[12];c[b+13]=a[13];c[b+14]=a[14];c[b+15]=a[15];return c},getPosition:function(){var a;return function(){if(a===undefined){a=new JETHREE.Vector3()}console.warn("JETHREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(u,j){var h=this.elements;var E=u.elements;var s=E[0],q=E[4],o=E[8],l=E[12];var D=E[1],C=E[5],B=E[9],A=E[13];var d=E[2],c=E[6],b=E[10],a=E[14];var t=E[3],r=E[7],p=E[11],n=E[15];h[0]=B*a*r-A*b*r+A*c*p-C*a*p-B*c*n+C*b*n;h[4]=l*b*r-o*a*r-l*c*p+q*a*p+o*c*n-q*b*n;h[8]=o*A*r-l*B*r+l*C*p-q*A*p-o*C*n+q*B*n;h[12]=l*B*c-o*A*c-l*C*b+q*A*b+o*C*a-q*B*a;h[1]=A*b*t-B*a*t-A*d*p+D*a*p+B*d*n-D*b*n;h[5]=o*a*t-l*b*t+l*d*p-s*a*p-o*d*n+s*b*n;h[9]=l*B*t-o*A*t-l*D*p+s*A*p+o*D*n-s*B*n;h[13]=o*A*d-l*B*d+l*D*b-s*A*b-o*D*a+s*B*a;h[2]=C*a*t-A*c*t+A*d*r-D*a*r-C*d*n+D*c*n;h[6]=l*c*t-q*a*t-l*d*r+s*a*r+q*d*n-s*c*n;h[10]=q*A*t-l*C*t+l*D*r-s*A*r-q*D*n+s*C*n;h[14]=l*C*d-q*A*d-l*D*c+s*A*c+q*D*a-s*C*a;h[3]=B*c*t-C*b*t-B*d*r+D*b*r+C*d*p-D*c*p;h[7]=q*b*t-o*c*t+o*d*r-s*b*r-q*d*p+s*c*p;h[11]=o*C*t-q*B*t-o*D*r+s*B*r+q*D*p-s*C*p;h[15]=q*B*d-o*C*d+o*D*c-s*B*c-q*D*b+s*C*b;var e=s*h[0]+D*h[4]+d*h[8]+t*h[12];if(e===0){var g="JETHREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(j||false){throw new Error(g)}else{console.warn(g)}this.identity();return this}this.multiplyScalar(1/e);return this},translate:function(a){console.error("JETHREE.Matrix4: .translate() has been removed.")},rotateX:function(a){console.error("JETHREE.Matrix4: .rotateX() has been removed.")},rotateY:function(a){console.error("JETHREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(a){console.error("JETHREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(a,b){console.error("JETHREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(b){var d=this.elements;var a=b.x,e=b.y,c=b.z;d[0]*=a;d[4]*=e;d[8]*=c;d[1]*=a;d[5]*=e;d[9]*=c;d[2]*=a;d[6]*=e;d[10]*=c;d[3]*=a;d[7]*=e;d[11]*=c;return this},getMaxScaleOnAxis:function(){var c=this.elements;var d=c[0]*c[0]+c[1]*c[1]+c[2]*c[2];var b=c[4]*c[4]+c[5]*c[5]+c[6]*c[6];var a=c[8]*c[8]+c[9]*c[9]+c[10]*c[10];return Math.sqrt(Math.max(d,b,a))},makeTranslation:function(a,c,b){this.set(1,0,0,a,0,1,0,c,0,0,1,b,0,0,0,1);return this},makeRotationX:function(a){var d=Math.cos(a),b=Math.sin(a);this.set(1,0,0,0,0,d,-b,0,0,b,d,0,0,0,0,1);return this},makeRotationY:function(a){var d=Math.cos(a),b=Math.sin(a);this.set(d,0,b,0,0,1,0,0,-b,0,d,0,0,0,0,1);return this},makeRotationZ:function(a){var d=Math.cos(a),b=Math.sin(a);this.set(d,-b,0,0,b,d,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var g=Math.cos(b);var n=Math.sin(b);var m=1-g;var l=a.x,j=a.y,h=a.z;var e=m*l,d=m*j;this.set(e*l+g,e*j-n*h,e*h+n*j,0,e*j+n*h,d*j+g,d*h-n*l,0,e*h-n*j,d*h+n*l,m*h*h+g,0,0,0,0,1);return this},makeScale:function(a,c,b){this.set(a,0,0,0,0,c,0,0,0,0,b,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a,b;return function(l,j,h){if(a===undefined){a=new JETHREE.Vector3()}if(b===undefined){b=new JETHREE.Matrix4()}var g=this.elements;var p=a.set(g[0],g[1],g[2]).length();var o=a.set(g[4],g[5],g[6]).length();var n=a.set(g[8],g[9],g[10]).length();var m=this.determinant();if(m<0){p=-p}l.x=g[12];l.y=g[13];l.z=g[14];b.elements.set(this.elements);var e=1/p;var d=1/o;var c=1/n;b.elements[0]*=e;b.elements[1]*=e;b.elements[2]*=e;b.elements[4]*=d;b.elements[5]*=d;b.elements[6]*=d;b.elements[8]*=c;b.elements[9]*=c;b.elements[10]*=c;j.setFromRotationMatrix(b);h.x=p;h.y=o;h.z=n;return this}}(),makeFrustum:function(h,t,e,q,l,j){var g=this.elements;var s=2*l/(t-h);var p=2*l/(q-e);var r=(t+h)/(t-h);var o=(q+e)/(q-e);var n=-(j+l)/(j-l);var m=-2*j*l/(j-l);g[0]=s;g[4]=0;g[8]=r;g[12]=0;g[1]=0;g[5]=p;g[9]=o;g[13]=0;g[2]=0;g[6]=0;g[10]=n;g[14]=m;g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makePerspective:function(e,c,h,b){var a=h*Math.tan(JETHREE.Math.degToRad(e*0.5));var g=-a;var j=g*c;var d=a*c;return this.makeFrustum(j,d,g,a,h,b)},makeOrthographic:function(d,r,n,a,j,g){var c=this.elements;var q=r-d;var e=n-a;var b=g-j;var o=(r+d)/q;var m=(n+a)/e;var l=(g+j)/b;c[0]=2/q;c[4]=0;c[8]=0;c[12]=-o;c[1]=0;c[5]=2/e;c[9]=0;c[13]=-m;c[2]=0;c[6]=0;c[10]=-2/b;c[14]=-l;c[3]=0;c[7]=0;c[11]=0;c[15]=1;return this},equals:function(a){var d=this.elements;var c=a.elements;for(var b=0;b<16;b++){if(d[b]!==c[b]){return false}}return true},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]}};JETHREE.Sphere=function(b,a){this.center=(b!==undefined)?b:new JETHREE.Vector3();this.radius=(a!==undefined)?a:0};JETHREE.Sphere.prototype={constructor:JETHREE.Sphere,set:function(b,a){this.center.copy(b);this.radius=a;return this},setFromPoints:function(){var a=new JETHREE.Box3();return function(g,h){var b=this.center;if(h!==undefined){b.copy(h)}else{a.setFromPoints(g).center(b)}var c=0;for(var e=0,d=g.length;e<d;e++){c=Math.max(c,b.distanceToSquared(g[e]))}this.radius=Math.sqrt(c);return this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return(this.radius<=0)},containsPoint:function(a){return(a.distanceToSquared(this.center)<=(this.radius*this.radius))},distanceToPoint:function(a){return(a.distanceTo(this.center)-this.radius)},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=(b*b)},clampPoint:function(b,d){var c=this.center.distanceToSquared(b);var a=d||new JETHREE.Vector3();a.copy(b);if(c>(this.radius*this.radius)){a.sub(this.center).normalize();a.multiplyScalar(this.radius).add(this.center)}return a},getBoundingBox:function(a){var b=a||new JETHREE.Box3();b.set(this.center,this.center);b.expandByScalar(this.radius);return b},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius=this.radius*a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&(a.radius===this.radius)}};JETHREE.Face3=function(g,e,l,j,h,d){this.a=g;this.b=e;this.c=l;this.normal=j instanceof JETHREE.Vector3?j:new JETHREE.Vector3();this.vertexNormals=Array.isArray(j)?j:[];this.color=h instanceof JETHREE.Color?h:new JETHREE.Color();this.vertexColors=Array.isArray(h)?h:[];this.materialIndex=d!==undefined?d:0};JETHREE.Face3.prototype={constructor:JETHREE.Face3,clone:function(){return new this.constructor().copy(this)},copy:function(c){this.a=c.a;this.b=c.b;this.c=c.c;this.normal.copy(c.normal);this.color.copy(c.color);this.materialIndex=c.materialIndex;for(var b=0,a=c.vertexNormals.length;b<a;b++){this.vertexNormals[b]=c.vertexNormals[b].clone()}for(var b=0,a=c.vertexColors.length;b<a;b++){this.vertexColors[b]=c.vertexColors[b].clone()}return this}};var JElib_maths={degToRad:function(a){return(a*Math.PI/180)},clamp:function(b,c,a){return Math.min(Math.max(b,c),a)},smoothStep:function(c,b,a){const d=Math.min(Math.max((a-c)/(b-c),0),1);return d*d*(3-2*d)}};var JElib_matrix={get_projectionPerspective:function(h,c,g,e){const d=Math.tan(JElib_maths.degToRad(0.5*h)),b=-(e+g)/(e-g),j=(-2*e*g)/(e-g);return[0.5/d,0,0,0,0,0.5*c/d,0,0,0,0,b,-1,0,0,j,0]},get_projectionOrtho:function(d,b,e,c){const a=-2/(c-e);const g=-(c+e)/(c-e);return[2/d,0,0,0,0,2/b,0,0,0,0,a,0,0,0,g,1]}};var JElib_ajax={get_jsonAJAX:function(b,d,c){console.log("INFO in JElib_ajax - request: ",b);const a=new XMLHttpRequest();a.open("GET",b,true);a.withCredentials=false;let isErrorDispatched=false;a.onreadystatechange=function(){if(a.status===404&&!isErrorDispatched){console.log("ERROR 404 in JElib_ajax: url =",b);isErrorDispatched=true;if(c){c(404)}}if(a.readyState===4&&a.status===200){console.log("INFO in JElib_ajax - ajax done for: url =",b);let jsonParsed=null;try{jsonParsed=JSON.parse(a.responseText)}catch(e){console.log("ERROR: cannot parse JSON for url =",b);if(c){c(-1)}}if(d&&jsonParsed){d(jsonParsed)}}};a.onerror=function(){if(c){c(0)}};a.send()},get_json:function(a,c,b){if(typeof(a)==="object"){c(a);return}JElib_ajax.get_jsonAJAX(a,c,b)}};const JElib_geometry={compute_faceNormals:function(c,e){const a=new JETHREE.Vector3(),j=new JETHREE.Vector3();for(let f=0,fl=e.length;f<fl;f++){const h=e[f];const g=c[h.a];const d=c[h.b];const b=c[h.c];a.subVectors(b,d);j.subVectors(g,d);a.cross(j);if(a.lengthSq()===0){console.log("WARNING in JElib_geometry - compute_faceNormals(): a face normal has a null size");continue}a.normalize();h.normal.copy(a)}},compute_vertexNormals:function(n,m,h){const j=new Array(n.length);for(let v=0,vl=n.length;v<vl;++v){j[v]=new JETHREE.Vector3()}if(h){const g=new JETHREE.Vector3(),p=new JETHREE.Vector3();for(let f=0,fl=m.length;f<fl;++f){const l=m[f];const d=n[l.a];const c=n[l.b];const b=n[l.c];g.subVectors(b,c);p.subVectors(d,c);g.cross(p);j[l.a].add(g);j[l.b].add(g);j[l.c].add(g)}}else{for(let f=0,fl=m.length;f<fl;++f){const a=m[f];j[a.a].add(a.normal);j[a.b].add(a.normal);j[a.c].add(a.normal)}}for(let v=0,vl=n.length;v<vl;++v){j[v].normalize()}for(let f=0,fl=m.length;f<fl;++f){const o=m[f];const e=o.vertexNormals;if(e.length===3){e[0].copy(j[o.a]);e[1].copy(j[o.b]);e[2].copy(j[o.c])}else{e[0]=j[o.a].clone();e[1]=j[o.b].clone();e[2]=j[o.c].clone()}}return j},compute_tangents:function(e,p,A,b){const q=e.length;const o=new Float32Array(q*4);const c=new Array(q),a=new Array(q);for(let k=0;k<q;k++){c[k]=new JETHREE.Vector3();a[k]=new JETHREE.Vector3()}const u=new JETHREE.Vector3(),t=new JETHREE.Vector3(),r=new JETHREE.Vector3(),j=new JETHREE.Vector2(),h=new JETHREE.Vector2(),g=new JETHREE.Vector2(),s=new JETHREE.Vector3(),E=new JETHREE.Vector3();function D(L){const Q=L.a,O=L.b,M=L.c;u.copy(e[Q]);t.copy(e[O]);r.copy(e[M]);j.copy(A[Q]);h.copy(A[O]);g.copy(A[M]);const G=t.x-u.x;const F=r.x-u.x;const P=t.y-u.y;const N=r.y-u.y;const I=t.z-u.z;const H=r.z-u.z;const S=h.x-j.x;const R=g.x-j.x;const K=h.y-j.y;const J=g.y-j.y;const n=1/(S*J-R*K);s.set((J*G-K*F)*n,(J*P-K*N)*n,(J*I-K*H)*n);E.set((S*F-R*G)*n,(S*N-R*P)*n,(S*H-R*I)*n);c[Q].add(s);c[O].add(s);c[M].add(s);a[Q].add(E);a[O].add(E);a[M].add(E)}b.forEach(D);const C=new JETHREE.Vector3(),l=new JETHREE.Vector3();const m=new JETHREE.Vector3(),d=new JETHREE.Vector3();function B(F){m.copy(p[F]);d.copy(m);const G=c[F];C.copy(G);C.sub(m.multiplyScalar(m.dot(G))).normalize();l.crossVectors(d,G);const H=l.dot(a[F]);const n=(H<0)?-1:1;o[F*4]=C.x;o[F*4+1]=C.y;o[F*4+2]=C.z;o[F*4+3]=n}b.forEach(function(n){B(n.a);B(n.b);B(n.c)});return o}};var JElib_vector2={scale:function(a,b){a[0]*=b;a[1]*=b},scaleNew:function(a,b){return[a[0]*b,a[1]*b]},scaleXYNew:function(a,b){return[a[0]*b[0],a[1]*b[1]]},distance2:function(b,a){return(b[0]-a[0])*(b[0]-a[0])+(b[1]-a[1])*(b[1]-a[1])},distanceFromScalars:function(c,b,a,d){return Math.sqrt((c-a)*(c-a)+(b-d)*(b-d))},distance2X:function(b,a){return(b[0]-a[0])*(b[0]-a[0])},subNew:function(b,a){return[b[0]-a[0],b[1]-a[1]]},fmaNew:function(d,c,e){return[d[0]+c[0]*e,d[1]+c[1]*e]},interpolateNew:function(d,c,e){return[d[0]*(1-e)+c[0]*e,d[1]*(1-e)+c[1]*e]},copyNew:function(a){return[a[0],a[1]]},copyArray:function(b){const c=[];for(let i=0;i<b.length;i++){c.push(this.copyNew(b[i]))}},sortArrayLeftRightNew:function(c){const b=this.copyArray(c);b.sort(function(d,a){return d[0]-a[0]});return b},round:function(a){a[0]=Math.round(a[0]),a[1]=Math.round(a[1])},dot:function(b,a){return b[0]*a[0]+b[1]*a[1]},size:function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}};